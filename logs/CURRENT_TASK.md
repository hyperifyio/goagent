E2E scenario test for state persistence: save, restore, refine, assert latest.json points to newest and prompts precedence.